---
// src/components/Footer.astro
import { getCollection } from "astro:content";

// Fetch collections
const services = await getCollection("works");

// Filter for footer items
const footerServices = services.filter((item) => item.data.footer_listed);

// Site configuration
const currentYear = new Date().getFullYear();
const siteEmail = "info@junglestar.org";
const siteName = "Junglestar";

// Helper to check if current page
const currentPath = Astro.url.pathname;
---

<footer class="flex flex_cols flex_justify_center">
    <a
        title="clicking this link will send you back to this junglestar.org homepage"
        href="/"
        class="footer_icon action_button back_home"
    >
        <!-- Logo SVG - you can import this as a component or inline it -->
        <svg
            class="logo"
            viewBox="0 0 400 400"
            aria-label="click to go back to the homepage"
        >
            <path
                fill="currentColor"
                d="M328.813 60.47L328.78 224.3c-.006 43.783-11.565 75.953-34.648 96.506-23.096 20.562-53.638 31.03-91.638 31.43-38.827.4-69.976-9.04-93.463-28.317-23.496-19.284-35.235-44.104-35.228-74.486.003-13.4 6.537-20.18 19.618-20.315 13.89-.144 20.838 4.912 20.835 15.163 0 22.482 7.86 40.15 23.593 53.008 15.72 12.85 36.863 19.146 63.433 18.87 27.783-.29 49.23-8.007 64.355-23.153 15.116-15.146 22.688-37.906 22.693-68.28l.036-192.883C261.95 17.906 231.884 10 200 10 95.233 10 10 95.234 10 200.002 10 304.77 95.233 390 200 390c104.766 0 190-85.23 190-189.998 0-55.104-23.588-104.795-61.187-139.533zM56.593 184.72l52.3-49.918-12.416-70.414 64.732 33.195L225.88 64.28l-12.297 70.435 52.39 49.832-72.33 10.334-32.296 64.1-32.408-64.044-72.35-10.215z"
            ></path>
        </svg>
    </a>

    <div class="footer_block">
        <div class="action_title revealed">{siteName}</div>

        <div class="footer_block_pages" role="menu">
            {
                footerServices.map((item) => {
                    const itemUrl = `/services/${item.slug}`;
                    const isActive = currentPath.includes(itemUrl);

                    return (
                        <a
                            class={`menu_item center ${isActive ? "active" : ""}`}
                            role="menuitem"
                            title={item.data.title}
                            href={itemUrl}
                        >
                            <span class="page_title">{item.data.title}</span>
                        </a>
                    );
                })
            }
        </div>

        <div class="footer_block_contacts">
            <a
                title="send us an email"
                class="action_button mail"
                href={`mailto:${siteEmail}`}
            >
                <span class="center revealed">Get in touch.</span>
                <span class="center reveal_on_hover">Send email.</span>

                <!-- Email icon SVG -->
                <svg class="email" viewBox="0 0 24 24">
                    <path
                        fill="currentColor"
                        d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"
                    ></path>
                </svg>
            </a>

            <div class="flex_item qr white">
                <div class="center">phone link</div>

                <svg class="qr white" viewBox="0 0 296 296">
                    <title>https://junglesrat.org QRcode</title>

                    <path fill="none" d="M0 0h296v296H0z"></path>

                    <path
                        fill="currentColor"
                        d="M32 184v8h8v-8h-8zM88 32H32v56h56V32zm-8 48H40V40h40v40zm-32 96h8v-16h-8v8h-8v-8h8v-8h-8v-24h8v8h8v-8h8v-8h-8v-8h16v8h24v-8H80v-8h-8v-8h-8v8h-8v-8H40v8h-8v8h8v8h-8v56h8v8h8v-8zm8 8h-8v8h-8v8h24v-8h-8v-8zM72 48H48v24h24V48zm-8 96h8v-8H56v8h-8v8h8v8h16v-8h-8v-8zM48 248h24v-24H48v24zm16-72h8v-8h-8v8zm0 8v8h8v-8h-8zm8 16h16v-8H72v8zm-40 64h56v-56H32v56zm8-48h40v40H40v-40zm32-80h24v-8H72v8zm0 8v8h16v-8H72zm8 40h8v-8h-8v8zm16-88H80v8h16v-8zm-8 88v8h8v-8h-8zm16-80h-8v8h8v-8zm0 24v-8h-8v8h8zm-8 128h8v-16h-8v16zm8-152h16v-8h-8v-8h-8v-8h-8v16h8v8zm8 16v8h8v8h-8v8h24v-16h-8v-8h-8v-8h-16v8h8zm-8 8v8h8v-8h-8zm8 80v-8h-8v-8h-8v24h8v-8h8zm0-168v24h-8V40h8v-8H96v40h24V40h-8zm8 40h-8v8h8v-8zm16 160v-8h-16v-16h-16v8h-8v8h16v16h8v-8h16zm-16 24h8v-8h8v-8h-16v16zm8-176h8V72h-16v8h8v8zm8 136v-8h-8v8h8zm8 40v-8h-8v8h8zm8-184h8V64h-8V48h-16v8h8v8h-8v8h16v8zm0 0h-8v8h8v-8zm-8 32V88h-8v8h-8v8h8v16h16v-8h-8zm0 24h8v-8h-8v8zm0 64h-24v8h32v-16h-8v8zm8 24v-8h-8v8h8zm0-136v8h8v-8h-8zm-8 64v-8h-8v8h-24v-8H96v8h8v8h8v8H96v-16h-8v8h-8v8h8v8h24v8h-8v8h8v8h8v-8h8v-8h8v8h8v-8h8v-8h8v-8h-8v-8h8v-24h-8v16h-8zm0 24h-24v-8h24v8zm16 16v-8h-8v8h8zm-8 72h8v-8h-8v8zm16-224h-8v-8h-24v8h16v8h16v-8zm0 48v-8h-8v8h8zm-8 16h8v-8h-8v8zm16-32h-8v8h8v-8zm-8 80h8v-8h-8v8zm0 32v16h-8v8h16v-24h-8zm8-112h8v8h8v8h-8v-8h-8v8h-8v8h8v8h-8v8h-8v8h-8v8h16v8h8v-8h16v-8h-16v-8h16v-8h-8v-8h16V72h-8v-8h-8v-8h8v-8h-8V32h-16v8h8v32zm8 176h8v-8h-8v8zm16-136h8v-8h-8v8zm0 16h8v8h-16v16h8v8h-16v24h8v8h-8v16h-8v8h-8v8h8v8h-8v-8h-8v8h-8v8h-16v8h24v8h8v8h8v-8h8v-8h-16v-8h16v-24h8v24h16v-8h16v8h-8v16h8v-8h16v-8h-8v-8h8v-8h-8v-32h-8v-8h-16v8h-8v-8h8v-24h16v-32h-8v-8h-16v8zm24 72v24h-24v-24h24zm-8-48h-8v-8h8v8zm-8 96h-8v8h-8v8h24v-8h-8v-8zm0-152v8h8v-8h-8zm8 112h-8v8h8v-8zm0-88h8v-16h-8v16zm24 144v-8h-16v8h16zm8-216h-24v24h24V48zm-8 72h-8v8h8v-8zm-8 40v8h8v-8h-8zm16 80v-8h-8v8h8zm-24-136h8v8h8v-8h16v8h-8v16h8v-8h8V96h-40v8zm24 160h16v-8h-8v-8h-8v16zM208 32v56h56V32h-56zm48 48h-40V40h40v40zm0 64h-16v8h24v-16h-8v8zm8 80h-8v-8h8v-56h-8v8h-16v8h8v32h-8v8h8v16h16v-8zm-8 24h8v-8h-8v8z"
                    ></path>
                </svg>
            </div>
        </div>

        <p class="center">
            <small>
                &copy; {currentYear}
                {siteName}.org | All rights reserved</small
            >
        </p>
    </div>
</footer>

<style>
    .white {
        color: var(--white);
    }
    /* Component-specific styles can go here if needed */
    /* Your global styles already handle most of the styling */
</style>
