---
// src/components/WorksCard.astro
export interface Props {
  id: string;
  title: string;
  subtitle?: string | null;
  category?: string | null;
  tags: string[];
  url: string;
  icon?: {
    url: string;
    name: string;
  };
  ico_url: string;
  permalink?: string;
  description?: string | null;
  date?: string;
}

const { title, subtitle, category, tags, url, icon, ico_url, description, date } = Astro.props;
const tag = tags?.[0] || "";
---

<style>
  .card_works_link {
    min-height: 288px;
    display: grid;
    grid-template-rows: auto 1fr auto;
    row-gap: calc(var(--space) / 2);
    padding-block: calc(var(--space_block) / 2);
    text-decoration: none;
    color: var(--brand);
    background-color: hsla(0, 0%, 95%, 1);
    border-radius: var(--radius);
    border: 1px solid var(--brand);
  }
  .card_works_link::after {
    display: none;
  }

  .icon_works {
    width: 25%;
    min-width: 111px;
    height: auto;
    object-fit: contain;
    justify-self: center;
    padding-bottom: var(--space_block);
  }

  .title_works {
    /*h3*/
    margin: 0;
    padding-bottom: 0;
    font-size: calc(var(--font_clamp) / 0.88);
    text-align: center;
    font-weight: 500;
    padding-inline: var(--space_inline);
    color: var(--brand);
  }

  .subtitle_works {
    display: block;
    font-size: 1rem;
    font-weight: normal;
    color: var(--text_color);
    margin-top: 0.25rem;
  }

  .meta_works {
    font-size: 0.875rem;
    color: var(--text_color);
    text-align: center;
    margin-top: 0.5rem;
  }

  .date_works {
    display: block;
    font-size: 0.75rem;
    opacity: 0.7;
    margin-bottom: 0.25rem;
  }

  .description_works {
    display: block;
    font-size: 0.875rem;
    line-height: 1.4;
    margin-top: 0.5rem;
  }

  .tags_works {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
    justify-content: center;
    margin-top: 0.5rem;
  }

  .tag_item {
    font-size: 0.75rem;
    padding: 0.125rem 0.5rem;
    background-color: var(--brand);
    color: white;
    border-radius: calc(var(--radius) / 2);
  }

  .webapp:before {
    content: "APP";
    display: block;
    position: absolute;
    top: 10px;
    right: 10px;
    padding-right: 10px;
    padding-left: 10px;
    border: 1px solid var(--brand);
    background-color: inherit;
    color: var(--brand);
    font-size: calc(var(--font_rem) / 1.5);
    font-weight: 400;
  }
</style>

<a href={url} target="_blank" rel="noopener noreferrer" class="card no_underline card_works_link">
  <div class={category + " " + tag}></div>
  {ico_url && <img src={ico_url} alt={icon?.name || title} class="icon_works" loading="lazy" />}

  <h3 class="title_works center">
    {title}
    {subtitle && <span class="subtitle_works">{subtitle}</span>}
  </h3>

  {
    date && (
      <div class="meta_works">
        <span class="date_works">
          {new Date(date).toLocaleDateString("en-US", { year: "numeric", month: "short" })}
        </span>
      </div>
    )
  }

  {description && <span class="description_works center">{description}</span>}

  {
    tags && tags.length > 0 && (
      <div class="tags_works">
        {tags.map((t) => (
          <span class="tag_item">{t}</span>
        ))}
      </div>
    )
  }
</a>
